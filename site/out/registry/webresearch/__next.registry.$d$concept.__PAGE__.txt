1:"$Sreact.fragment"
2:I[27130,["/agent-utils/_next/static/chunks/eea70fb79868b250.js","/agent-utils/_next/static/chunks/15aae2d08be8e623.js"],""]
e:I[71831,["/agent-utils/_next/static/chunks/e57f8bd634e3e83c.js","/agent-utils/_next/static/chunks/152d0cd9196fc828.js"],"OutletBoundary"]
f:"$Sreact.suspense"
11:I[27655,["/agent-utils/_next/static/chunks/eea70fb79868b250.js","/agent-utils/_next/static/chunks/15aae2d08be8e623.js"],"PlatformTabs"]
0:{"buildId":"q6BYXdNsX4MHpa25z5ku2","rsc":["$","$1","c",{"children":[["$","main",null,{"className":"min-h-screen bg-background","children":["$","div",null,{"className":"relative","children":[["$","div",null,{"className":"pointer-events-none absolute inset-0 overflow-hidden","children":[["$","div",null,{"className":"absolute -left-24 top-16 h-64 w-64 rounded-full bg-orange-200/30 blur-3xl"}],["$","div",null,{"className":"absolute right-[-120px] top-40 h-72 w-72 rounded-full bg-cyan-200/30 blur-3xl"}],["$","div",null,{"className":"absolute inset-0 bg-[linear-gradient(to_right,rgba(15,23,42,0.06)_1px,transparent_1px),linear-gradient(to_bottom,rgba(15,23,42,0.06)_1px,transparent_1px)] bg-[size:72px_72px] opacity-40"}]]}],["$","header",null,{"className":"sticky top-0 z-30 border-b border-border/60 bg-background/80 backdrop-blur","children":["$","div",null,{"className":"flex w-full items-center gap-6 px-4 py-3 sm:px-6 xl:px-10","children":[["$","$L2",null,{"href":"/","className":"flex items-center gap-3","children":[["$","div",null,{"className":"flex h-10 w-10 items-center justify-center rounded-xl bg-slate-900 text-white shadow-sm","children":"AU"}],["$","div",null,{"className":"hidden sm:flex flex-col","children":["$","span",null,{"className":"text-xs font-semibold uppercase tracking-[0.24em] text-slate-600","children":"Agent Utils"}]}]]}],["$","nav",null,{"className":"hidden lg:flex items-center gap-4 text-sm font-medium text-muted-foreground","children":[["$","$L2",null,{"href":"/","className":"hover:text-foreground","children":"Home"}],["$","$L2",null,{"href":"/registry","className":"hover:text-foreground","children":"Registry"}]]}],["$","div",null,{"className":"hidden md:block flex-1","children":["$","div",null,{"className":"max-w-md","children":["$","input",null,{"aria-label":"Search registry","className":"w-full rounded-xl border border-border/70 bg-white/80 px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground shadow-sm","placeholder":"Search registry...","type":"search"}]}]}],["$","div",null,{"className":"ml-auto flex items-center gap-2","children":[["$","a",null,{"href":"https://github.com/brennanmceachran/agent-utils","target":"_blank","rel":"noreferrer","children":"GitHub","className":"items-center justify-center gap-2 rounded-lg text-sm font-semibold tracking-tight transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 ring-offset-background border border-border/70 bg-transparent text-foreground hover:bg-muted/70 h-11 px-5 py-2.5 hidden sm:inline-flex","ref":null}],["$","$L2",null,{"href":"/registry","children":"Browse registry","className":"inline-flex items-center justify-center gap-2 rounded-lg text-sm font-semibold tracking-tight transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 ring-offset-background border border-border/70 bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/70 h-11 px-5 py-2.5","ref":null}]]}]]}]}],["$","div",null,{"className":"relative w-full px-4 pb-16 pt-6 sm:px-6 xl:px-10","children":["$","div",null,{"className":"mt-6 grid gap-8 lg:grid-cols-[minmax(200px,240px)_minmax(0,720px)_minmax(0,1fr)] xl:grid-cols-[minmax(240px,1fr)_minmax(0,760px)_minmax(240px,1fr)]","children":[["$","aside",null,{"className":"hidden lg:flex lg:flex-col lg:sticky lg:top-20 lg:h-[calc(100vh-6rem)] lg:justify-self-start lg:overflow-y-auto lg:pr-2","children":["$","div",null,{"className":"space-y-6","children":["$","div",null,{"className":"space-y-2","children":[["$","p",null,{"className":"text-xs font-semibold uppercase tracking-[0.24em] text-muted-foreground","children":"Registry"}],["$","nav",null,{"className":"space-y-1","children":[["$","$L2","nextjs-mcp",{"href":"/registry/nextjs-mcp","className":"flex items-center justify-between rounded-xl px-3 py-2 text-sm font-medium transition text-muted-foreground hover:bg-muted/60 hover:text-foreground","children":"$L3"}],"$L4","$L5"]}]]}]}]}],"$L6","$L7"]}]}]]}]}],["$L8","$L9"],"$La"]}],"loading":null,"isPartial":false}
3:["$","span",null,{"children":"Next.js MCP"}]
4:["$","$L2","ralph-loop",{"href":"/registry/ralph-loop","className":"flex items-center justify-between rounded-xl px-3 py-2 text-sm font-medium transition text-muted-foreground hover:bg-muted/60 hover:text-foreground","children":["$","span",null,{"children":"Ralph Loop"}]}]
5:["$","$L2","webresearch",{"href":"/registry/webresearch","aria-current":"page","className":"flex items-center justify-between rounded-xl px-3 py-2 text-sm font-medium transition bg-foreground text-background shadow-sm","children":["$","span",null,{"children":"Web Research"}]}]
6:["$","div",null,{"className":"min-w-0 max-w-full lg:justify-self-center","children":["$","div",null,{"className":"space-y-14","children":[["$","section",null,{"className":"space-y-6","children":[["$","div",null,{"className":"flex flex-wrap items-center gap-3","children":[["$","div",null,{"className":"inline-flex items-center rounded-full border px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.08em] transition-colors border-border/70 bg-white/70 text-muted-foreground","children":"OpenCode ready"}],["$","div",null,{"className":"inline-flex items-center rounded-full border px-3 py-1 text-[11px] font-semibold uppercase tracking-[0.08em] transition-colors border-border/70 bg-white/70 text-muted-foreground","children":[1," ","variant"]}]]}],["$","div",null,{"className":"space-y-3","children":[["$","h1",null,{"className":"text-3xl font-semibold tracking-tight text-slate-900 sm:text-4xl","children":"Web Research"}],["$","p",null,{"className":"text-lg text-muted-foreground","children":"OpenCode tool that runs codex web research with summaries and source URLs."}]]}],["$","div",null,{"className":"rounded-2xl border border-border/70 text-card-foreground shadow-sm backdrop-blur bg-white/80","children":[["$","div",null,{"className":"flex flex-col space-y-2 p-6","children":["$","h3",null,{"className":"text-base font-semibold tracking-tight","children":"Quick start"}]}],["$","div",null,{"className":"p-6 pt-0","children":["$","div",null,{"className":"markdown","children":[["$","p","0",{"children":["$","strong",null,{"children":"What this gives you"}]}],"\n",["$","ul","2",{"children":["\n",["$","li","1",{"children":"A single tool call that returns a summary, key caveats, and source URLs."}],"\n",["$","li","3",{"children":"Preset depth controls (fast, balanced, deep)."}],"\n"]}],"\n",["$","p","4",{"children":["$","strong",null,{"children":"Try it"}]}],"\n",["$","pre","6",{"className":"shiki vitesse-light","style":{"backgroundColor":"#ffffff","color":"#393a34"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span","0",{"className":"line","children":[["$","span","0",{"style":{"color":"#998418"},"children":"tool"}],["$","span","1",{"style":{"color":"#999999"},"children":":"}],["$","span","2",{"style":{"color":"#B56959"},"children":" webresearch"}]]}],"\n",["$","span","2",{"className":"line","children":[["$","span","0",{"style":{"color":"#998418"},"children":"args"}],["$","span","1",{"style":{"color":"#999999"},"children":":"}]]}],"\n",["$","span","4",{"className":"line","children":[["$","span","0",{"style":{"color":"#998418"},"children":"  reason"}],["$","span","1",{"style":{"color":"#999999"},"children":":"}],["$","span","2",{"style":{"color":"#B5695977"},"children":" \""}],["$","span","3",{"style":{"color":"#B56959"},"children":"Decide whether to adopt Next.js MCP"}],["$","span","4",{"style":{"color":"#B5695977"},"children":"\""}]]}],"\n",["$","span","6",{"className":"line","children":[["$","span","0",{"style":{"color":"#998418"},"children":"  query"}],["$","span","1",{"style":{"color":"#999999"},"children":":"}],["$","span","2",{"style":{"color":"#B5695977"},"children":" \""}],["$","span","3",{"style":{"color":"#B56959"},"children":"Next.js MCP guide; next-devtools-mcp repo"}],["$","span","4",{"style":{"color":"#B5695977"},"children":"\""}]]}],"\n",["$","span","8",{"className":"line","children":[["$","span","0",{"style":{"color":"#998418"},"children":"  quality"}],["$","span","1",{"style":{"color":"#999999"},"children":":"}],["$","span","2",{"style":{"color":"#B56959"},"children":" balanced"}]]}]]}]}],"\n"]}]}]]}]]}],["$","section",null,{"id":"install","className":"scroll-mt-24 space-y-6","children":[["$","div",null,{"className":"flex flex-wrap items-center justify-between gap-4","children":[["$","div",null,{"className":"space-y-2","children":[["$","p",null,{"className":"text-xs font-semibold uppercase tracking-[0.24em] text-muted-foreground","children":"Installation"}],["$","h2",null,{"className":"text-2xl font-semibold tracking-tight text-slate-900","children":"Install"}]]}],["$","div",null,{"className":"min-w-[220px]","children":["$","select",null,{"aria-label":"Platform","defaultValue":"opencode","className":"w-full rounded-xl border border-border/70 bg-white/80 px-3 py-2 text-sm font-medium text-foreground shadow-sm","children":[["$","option",null,{"value":"opencode","children":"OpenCode"}],["$","option",null,{"value":"claude","disabled":true,"children":"Claude Code (soon)"}],["$","option",null,{"value":"codex","disabled":true,"children":"Codex CLI (soon)"}]]}]}]]}],"$Lb"]}],"$Lc",null,"$Ld"]}]}]
7:["$","aside",null,{"className":"hidden xl:flex xl:flex-col xl:sticky xl:top-20 xl:h-[calc(100vh-6rem)] xl:justify-self-end xl:overflow-y-auto xl:pl-2","children":["$","div",null,{"className":"space-y-4","children":[["$","p",null,{"className":"text-xs font-semibold uppercase tracking-[0.24em] text-muted-foreground","children":"On this page"}],["$","nav",null,{"className":"space-y-2 text-sm text-muted-foreground","children":[["$","a","install",{"href":"#install","className":"block rounded-md px-2 py-1 transition hover:bg-muted/60 hover:text-foreground","children":"Installation"}],["$","a","usage",{"href":"#usage","className":"block rounded-md px-2 py-1 transition hover:bg-muted/60 hover:text-foreground","children":"Usage"}],["$","a","notes",{"href":"#notes","className":"block rounded-md px-2 py-1 transition hover:bg-muted/60 hover:text-foreground","children":"Notes"}]]}]]}]}]
8:["$","script","script-0",{"src":"/agent-utils/_next/static/chunks/eea70fb79868b250.js","async":true}]
9:["$","script","script-1",{"src":"/agent-utils/_next/static/chunks/15aae2d08be8e623.js","async":true}]
a:["$","$Le",null,{"children":["$","$f",null,{"name":"Next.MetadataOutlet","children":"$@10"}]}]
12:Tdf3,import { tool } from "@opencode-ai/plugin";

const QUALITY_PRESETS = {
  fast: {
    effort: "low",
    directive: "Keep it quick; use only the most relevant sources.",
  },
  balanced: {
    effort: "medium",
    directive: "Cover the main angles; resolve contradictions if they appear.",
  },
  deep: {
    effort: "high",
    directive:
      "Follow second-order leads and resolve contradictions until extra sources stop adding value.",
  },
} as const;

type Quality = keyof typeof QUALITY_PRESETS;

function buildPrompt({
  reason,
  query,
  additionalContext,
  quality,
}: {
  reason: string;
  query: string;
  additionalContext?: string;
  quality: Quality;
}) {
  const preset = QUALITY_PRESETS[quality];
  const contextBlock = additionalContext
    ? `Additional context (optional): ${additionalContext}`
    : "Additional context (optional):";

  return [
    "Hi, I’m stuck and need help with a research task.",
    "",
    `Reason: ${reason}`,
    `Search queries: ${query}`,
    contextBlock,
    `Depth: ${quality}`,
    "",
    "Please search the web and send back:",
    "- A 2-4 sentence summary",
    "- Key findings or caveats (bullets)",
    "- Sources with full URLs",
    "",
    "If anything is ambiguous, cover the plausible interpretations and state your assumptions instead of asking questions.",
    "Please don’t edit any code or files.",
    preset.directive,
  ].join("\n");
}

async function runCodex({
  prompt,
  effort,
}: {
  prompt: string;
  effort: string;
}) {
  const args = [
    "exec",
    "--enable",
    "web_search_request",
    "--sandbox",
    "read-only",
    "-c",
    `model_reasoning_effort=${effort}`,
    prompt,
  ];

  const proc = Bun.spawn(["codex", ...args], {
    stdout: "pipe",
    stderr: "pipe",
  });

  const [stdout, stderr] = await Promise.all([
    new Response(proc.stdout).text(),
    new Response(proc.stderr).text(),
  ]);
  const exitCode = await proc.exited;

  if (exitCode !== 0) {
    const message = stderr.trim() || `codex exec failed with exit code ${exitCode}`;
    throw new Error(message);
  }

  return stdout.trim();
}

export default tool({
  description:
    "Run a web search and return a concise summary with source links. Expect 5-10 minutes for deep queries; only run parallel calls for separate deep dives (one run can handle multiple related queries).",
  args: {
    reason: tool.schema
      .string()
      .describe(
        "Describe the core reason you’re reaching for web search and the decision or output you’re aiming for.",
      ),
    query: tool.schema
      .string()
      .describe(
        'List the search queries you want run; use new lines or ";" to include multiple angles in one run. Only split into parallel calls for distinct deep dives.',
      ),
    additional_context: tool.schema
      .string()
      .optional()
      .describe(
        "Add constraints or background: versions, product names, prior findings, relevant files/code, or must-include sources.",
      ),
    quality: tool.schema
      .enum(["fast", "balanced", "deep"])
      .describe(
        "Fast = quick scan, balanced = normal depth, deep = thorough with follow-up leads (deep can take 5-10 minutes).",
      ),
  },
  async execute(args) {
    const quality = args.quality as Quality;
    const prompt = buildPrompt({
      reason: args.reason,
      query: args.query,
      additionalContext: args.additional_context,
      quality,
    });

    const effort = QUALITY_PRESETS[quality].effort;
    return runCodex({
      prompt,
      effort,
    });
  },
});
13:T61a3,<pre class="shiki vitesse-light" style="background-color:#ffffff;color:#393a34" tabindex="0"><code><span class="line"><span style="color:#1E754F">import</span><span style="color:#999999"> {</span><span style="color:#B07D48"> tool</span><span style="color:#999999"> }</span><span style="color:#1E754F"> from</span><span style="color:#B5695977"> "</span><span style="color:#B56959">@opencode-ai/plugin</span><span style="color:#B5695977">"</span><span style="color:#999999">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959">const </span><span style="color:#B07D48">QUALITY_PRESETS</span><span style="color:#999999"> =</span><span style="color:#999999"> {</span></span>
<span class="line"><span style="color:#998418">  fast</span><span style="color:#999999">: {</span></span>
<span class="line"><span style="color:#998418">    effort</span><span style="color:#999999">: </span><span style="color:#B5695977">"</span><span style="color:#B56959">low</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#998418">    directive</span><span style="color:#999999">: </span><span style="color:#B5695977">"</span><span style="color:#B56959">Keep it quick; use only the most relevant sources.</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#999999">  },</span></span>
<span class="line"><span style="color:#998418">  balanced</span><span style="color:#999999">: {</span></span>
<span class="line"><span style="color:#998418">    effort</span><span style="color:#999999">: </span><span style="color:#B5695977">"</span><span style="color:#B56959">medium</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#998418">    directive</span><span style="color:#999999">: </span><span style="color:#B5695977">"</span><span style="color:#B56959">Cover the main angles; resolve contradictions if they appear.</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#999999">  },</span></span>
<span class="line"><span style="color:#998418">  deep</span><span style="color:#999999">: {</span></span>
<span class="line"><span style="color:#998418">    effort</span><span style="color:#999999">: </span><span style="color:#B5695977">"</span><span style="color:#B56959">high</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#998418">    directive</span><span style="color:#999999">:</span></span>
<span class="line"><span style="color:#B5695977">      "</span><span style="color:#B56959">Follow second-order leads and resolve contradictions until extra sources stop adding value.</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#999999">  },</span></span>
<span class="line"><span style="color:#999999">}</span><span style="color:#1E754F"> as</span><span style="color:#AB5959"> const</span><span style="color:#999999">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959">type</span><span style="color:#2E8F82"> Quality</span><span style="color:#999999"> =</span><span style="color:#AB5959"> keyof</span><span style="color:#AB5959"> typeof</span><span style="color:#B07D48"> QUALITY_PRESETS</span><span style="color:#999999">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959">function</span><span style="color:#59873A"> buildPrompt</span><span style="color:#999999">({</span></span>
<span class="line"><span style="color:#B07D48">  reason</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B07D48">  query</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B07D48">  additionalContext</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B07D48">  quality</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#999999">}: {</span></span>
<span class="line"><span style="color:#B07D48">  reason</span><span style="color:#999999">: </span><span style="color:#2E8F82">string</span><span style="color:#999999">;</span></span>
<span class="line"><span style="color:#B07D48">  query</span><span style="color:#999999">: </span><span style="color:#2E8F82">string</span><span style="color:#999999">;</span></span>
<span class="line"><span style="color:#B07D48">  additionalContext</span><span style="color:#AB5959">?</span><span style="color:#999999">: </span><span style="color:#2E8F82">string</span><span style="color:#999999">;</span></span>
<span class="line"><span style="color:#B07D48">  quality</span><span style="color:#999999">: </span><span style="color:#2E8F82">Quality</span><span style="color:#999999">;</span></span>
<span class="line"><span style="color:#999999">})</span><span style="color:#999999"> {</span></span>
<span class="line"><span style="color:#AB5959">  const </span><span style="color:#B07D48">preset</span><span style="color:#999999"> =</span><span style="color:#B07D48"> QUALITY_PRESETS</span><span style="color:#999999">[</span><span style="color:#B07D48">quality</span><span style="color:#999999">];</span></span>
<span class="line"><span style="color:#AB5959">  const </span><span style="color:#B07D48">contextBlock</span><span style="color:#999999"> =</span><span style="color:#B07D48"> additionalContext</span></span>
<span class="line"><span style="color:#AB5959">    ?</span><span style="color:#B5695977"> `</span><span style="color:#B56959">Additional context (optional): </span><span style="color:#1E754F">${</span><span style="color:#B56959">additionalContext</span><span style="color:#1E754F">}</span><span style="color:#B5695977">`</span></span>
<span class="line"><span style="color:#AB5959">    :</span><span style="color:#B5695977"> "</span><span style="color:#B56959">Additional context (optional):</span><span style="color:#B5695977">"</span><span style="color:#999999">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F">  return</span><span style="color:#999999"> [</span></span>
<span class="line"><span style="color:#B5695977">    "</span><span style="color:#B56959">Hi, I’m stuck and need help with a research task.</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    ""</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    `</span><span style="color:#B56959">Reason: </span><span style="color:#1E754F">${</span><span style="color:#B56959">reason</span><span style="color:#1E754F">}</span><span style="color:#B5695977">`</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    `</span><span style="color:#B56959">Search queries: </span><span style="color:#1E754F">${</span><span style="color:#B56959">query</span><span style="color:#1E754F">}</span><span style="color:#B5695977">`</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B07D48">    contextBlock</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    `</span><span style="color:#B56959">Depth: </span><span style="color:#1E754F">${</span><span style="color:#B56959">quality</span><span style="color:#1E754F">}</span><span style="color:#B5695977">`</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    ""</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    "</span><span style="color:#B56959">Please search the web and send back:</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    "</span><span style="color:#B56959">- A 2-4 sentence summary</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    "</span><span style="color:#B56959">- Key findings or caveats (bullets)</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    "</span><span style="color:#B56959">- Sources with full URLs</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    ""</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    "</span><span style="color:#B56959">If anything is ambiguous, cover the plausible interpretations and state your assumptions instead of asking questions.</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    "</span><span style="color:#B56959">Please don’t edit any code or files.</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B07D48">    preset</span><span style="color:#999999">.</span><span style="color:#B07D48">directive</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#999999">  ].</span><span style="color:#59873A">join</span><span style="color:#999999">(</span><span style="color:#B5695977">"</span><span style="color:#A65E2B">\n</span><span style="color:#B5695977">"</span><span style="color:#999999">);</span></span>
<span class="line"><span style="color:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959">async</span><span style="color:#AB5959"> function</span><span style="color:#59873A"> runCodex</span><span style="color:#999999">({</span></span>
<span class="line"><span style="color:#B07D48">  prompt</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B07D48">  effort</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#999999">}: {</span></span>
<span class="line"><span style="color:#B07D48">  prompt</span><span style="color:#999999">: </span><span style="color:#2E8F82">string</span><span style="color:#999999">;</span></span>
<span class="line"><span style="color:#B07D48">  effort</span><span style="color:#999999">: </span><span style="color:#2E8F82">string</span><span style="color:#999999">;</span></span>
<span class="line"><span style="color:#999999">})</span><span style="color:#999999"> {</span></span>
<span class="line"><span style="color:#AB5959">  const </span><span style="color:#B07D48">args</span><span style="color:#999999"> =</span><span style="color:#999999"> [</span></span>
<span class="line"><span style="color:#B5695977">    "</span><span style="color:#B56959">exec</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    "</span><span style="color:#B56959">--enable</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    "</span><span style="color:#B56959">web_search_request</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    "</span><span style="color:#B56959">--sandbox</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    "</span><span style="color:#B56959">read-only</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    "</span><span style="color:#B56959">-c</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B5695977">    `</span><span style="color:#B56959">model_reasoning_effort=</span><span style="color:#1E754F">${</span><span style="color:#B56959">effort</span><span style="color:#1E754F">}</span><span style="color:#B5695977">`</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B07D48">    prompt</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#999999">  ];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959">  const </span><span style="color:#B07D48">proc</span><span style="color:#999999"> =</span><span style="color:#B07D48"> Bun</span><span style="color:#999999">.</span><span style="color:#59873A">spawn</span><span style="color:#999999">([</span><span style="color:#B5695977">"</span><span style="color:#B56959">codex</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span><span style="color:#999999"> ...</span><span style="color:#B07D48">args</span><span style="color:#999999">],</span><span style="color:#999999"> {</span></span>
<span class="line"><span style="color:#998418">    stdout</span><span style="color:#999999">: </span><span style="color:#B5695977">"</span><span style="color:#B56959">pipe</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#998418">    stderr</span><span style="color:#999999">: </span><span style="color:#B5695977">"</span><span style="color:#B56959">pipe</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#999999">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959">  const </span><span style="color:#999999">[</span><span style="color:#B07D48">stdout</span><span style="color:#999999">,</span><span style="color:#B07D48"> stderr</span><span style="color:#999999">]</span><span style="color:#999999"> =</span><span style="color:#1E754F"> await</span><span style="color:#998418"> Promise</span><span style="color:#999999">.</span><span style="color:#59873A">all</span><span style="color:#999999">([</span></span>
<span class="line"><span style="color:#AB5959">    new </span><span style="color:#59873A">Response</span><span style="color:#999999">(</span><span style="color:#B07D48">proc</span><span style="color:#999999">.</span><span style="color:#B07D48">stdout</span><span style="color:#999999">).</span><span style="color:#59873A">text</span><span style="color:#999999">(),</span></span>
<span class="line"><span style="color:#AB5959">    new </span><span style="color:#59873A">Response</span><span style="color:#999999">(</span><span style="color:#B07D48">proc</span><span style="color:#999999">.</span><span style="color:#B07D48">stderr</span><span style="color:#999999">).</span><span style="color:#59873A">text</span><span style="color:#999999">(),</span></span>
<span class="line"><span style="color:#999999">  ]);</span></span>
<span class="line"><span style="color:#AB5959">  const </span><span style="color:#B07D48">exitCode</span><span style="color:#999999"> =</span><span style="color:#1E754F"> await</span><span style="color:#B07D48"> proc</span><span style="color:#999999">.</span><span style="color:#B07D48">exited</span><span style="color:#999999">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F">  if</span><span style="color:#999999"> (</span><span style="color:#B07D48">exitCode</span><span style="color:#AB5959"> !==</span><span style="color:#2F798A"> 0</span><span style="color:#999999">)</span><span style="color:#999999"> {</span></span>
<span class="line"><span style="color:#AB5959">    const </span><span style="color:#B07D48">message</span><span style="color:#999999"> =</span><span style="color:#B07D48"> stderr</span><span style="color:#999999">.</span><span style="color:#59873A">trim</span><span style="color:#999999">()</span><span style="color:#AB5959"> || </span><span style="color:#B5695977">`</span><span style="color:#B56959">codex exec failed with exit code </span><span style="color:#1E754F">${</span><span style="color:#B56959">exitCode</span><span style="color:#1E754F">}</span><span style="color:#B5695977">`</span><span style="color:#999999">;</span></span>
<span class="line"><span style="color:#1E754F">    throw</span><span style="color:#AB5959"> new</span><span style="color:#59873A"> Error</span><span style="color:#999999">(</span><span style="color:#B07D48">message</span><span style="color:#999999">);</span></span>
<span class="line"><span style="color:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F">  return</span><span style="color:#B07D48"> stdout</span><span style="color:#999999">.</span><span style="color:#59873A">trim</span><span style="color:#999999">();</span></span>
<span class="line"><span style="color:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F">export</span><span style="color:#1E754F"> default</span><span style="color:#59873A"> tool</span><span style="color:#999999">({</span></span>
<span class="line"><span style="color:#998418">  description</span><span style="color:#999999">:</span></span>
<span class="line"><span style="color:#B5695977">    "</span><span style="color:#B56959">Run a web search and return a concise summary with source links. Expect 5-10 minutes for deep queries; only run parallel calls for separate deep dives (one run can handle multiple related queries).</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#998418">  args</span><span style="color:#999999">: {</span></span>
<span class="line"><span style="color:#998418">    reason</span><span style="color:#999999">: </span><span style="color:#B07D48">tool</span><span style="color:#999999">.</span><span style="color:#B07D48">schema</span></span>
<span class="line"><span style="color:#999999">      .</span><span style="color:#59873A">string</span><span style="color:#999999">()</span></span>
<span class="line"><span style="color:#999999">      .</span><span style="color:#59873A">describe</span><span style="color:#999999">(</span></span>
<span class="line"><span style="color:#B5695977">        "</span><span style="color:#B56959">Describe the core reason you’re reaching for web search and the decision or output you’re aiming for.</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#999999">      ),</span></span>
<span class="line"><span style="color:#998418">    query</span><span style="color:#999999">: </span><span style="color:#B07D48">tool</span><span style="color:#999999">.</span><span style="color:#B07D48">schema</span></span>
<span class="line"><span style="color:#999999">      .</span><span style="color:#59873A">string</span><span style="color:#999999">()</span></span>
<span class="line"><span style="color:#999999">      .</span><span style="color:#59873A">describe</span><span style="color:#999999">(</span></span>
<span class="line"><span style="color:#B5695977">        '</span><span style="color:#B56959">List the search queries you want run; use new lines or ";" to include multiple angles in one run. Only split into parallel calls for distinct deep dives.</span><span style="color:#B5695977">'</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#999999">      ),</span></span>
<span class="line"><span style="color:#998418">    additional_context</span><span style="color:#999999">: </span><span style="color:#B07D48">tool</span><span style="color:#999999">.</span><span style="color:#B07D48">schema</span></span>
<span class="line"><span style="color:#999999">      .</span><span style="color:#59873A">string</span><span style="color:#999999">()</span></span>
<span class="line"><span style="color:#999999">      .</span><span style="color:#59873A">optional</span><span style="color:#999999">()</span></span>
<span class="line"><span style="color:#999999">      .</span><span style="color:#59873A">describe</span><span style="color:#999999">(</span></span>
<span class="line"><span style="color:#B5695977">        "</span><span style="color:#B56959">Add constraints or background: versions, product names, prior findings, relevant files/code, or must-include sources.</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#999999">      ),</span></span>
<span class="line"><span style="color:#998418">    quality</span><span style="color:#999999">: </span><span style="color:#B07D48">tool</span><span style="color:#999999">.</span><span style="color:#B07D48">schema</span></span>
<span class="line"><span style="color:#999999">      .</span><span style="color:#59873A">enum</span><span style="color:#999999">([</span><span style="color:#B5695977">"</span><span style="color:#B56959">fast</span><span style="color:#B5695977">"</span><span style="color:#999999">, </span><span style="color:#B5695977">"</span><span style="color:#B56959">balanced</span><span style="color:#B5695977">"</span><span style="color:#999999">, </span><span style="color:#B5695977">"</span><span style="color:#B56959">deep</span><span style="color:#B5695977">"</span><span style="color:#999999">])</span></span>
<span class="line"><span style="color:#999999">      .</span><span style="color:#59873A">describe</span><span style="color:#999999">(</span></span>
<span class="line"><span style="color:#B5695977">        "</span><span style="color:#B56959">Fast = quick scan, balanced = normal depth, deep = thorough with follow-up leads (deep can take 5-10 minutes).</span><span style="color:#B5695977">"</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#999999">      ),</span></span>
<span class="line"><span style="color:#999999">  },</span></span>
<span class="line"><span style="color:#AB5959">  async</span><span style="color:#59873A"> execute</span><span style="color:#999999">(</span><span style="color:#B07D48">args</span><span style="color:#999999">) {</span></span>
<span class="line"><span style="color:#AB5959">    const </span><span style="color:#B07D48">quality</span><span style="color:#999999"> =</span><span style="color:#B07D48"> args</span><span style="color:#999999">.</span><span style="color:#B07D48">quality</span><span style="color:#1E754F"> as</span><span style="color:#2E8F82"> Quality</span><span style="color:#999999">;</span></span>
<span class="line"><span style="color:#AB5959">    const </span><span style="color:#B07D48">prompt</span><span style="color:#999999"> =</span><span style="color:#59873A"> buildPrompt</span><span style="color:#999999">({</span></span>
<span class="line"><span style="color:#998418">      reason</span><span style="color:#999999">: </span><span style="color:#B07D48">args</span><span style="color:#999999">.</span><span style="color:#B07D48">reason</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#998418">      query</span><span style="color:#999999">: </span><span style="color:#B07D48">args</span><span style="color:#999999">.</span><span style="color:#B07D48">query</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#998418">      additionalContext</span><span style="color:#999999">: </span><span style="color:#B07D48">args</span><span style="color:#999999">.</span><span style="color:#B07D48">additional_context</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B07D48">      quality</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#999999">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959">    const </span><span style="color:#B07D48">effort</span><span style="color:#999999"> =</span><span style="color:#B07D48"> QUALITY_PRESETS</span><span style="color:#999999">[</span><span style="color:#B07D48">quality</span><span style="color:#999999">].</span><span style="color:#B07D48">effort</span><span style="color:#999999">;</span></span>
<span class="line"><span style="color:#1E754F">    return</span><span style="color:#59873A"> runCodex</span><span style="color:#999999">({</span></span>
<span class="line"><span style="color:#B07D48">      prompt</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#B07D48">      effort</span><span style="color:#999999">,</span></span>
<span class="line"><span style="color:#999999">    });</span></span>
<span class="line"><span style="color:#999999">  },</span></span>
<span class="line"><span style="color:#999999">});</span></span>
<span class="line"></span></code></pre>b:["$","div",null,{"className":"rounded-2xl bg-white/80 p-6 shadow-sm","children":["$","$L11",null,{"opencodeVariant":{"$schema":"https://ui.shadcn.com/schema/registry-item.json","name":"webresearch-opencode","type":"registry:item","title":"OpenCode Web Research","description":"Web research tool that runs Codex web_search_request via OpenCode.","meta":{"concept":"webresearch","platform":"opencode","kind":["tool"],"installPath":"webresearch-opencode.v1.json"},"files":[{"path":"registry/webresearch/opencode/files/tool/webresearch.ts","type":"registry:file","target":"~/.opencode/tool/webresearch.ts"}],"docs":"Requires the `codex` CLI on PATH. Restart OpenCode after installing to register the tool. Targets prefixed with ~ are repo-scoped (project-root) paths."},"installCommand":"npx shadcn@latest add https://your-site-url/agent-utils/webresearch-opencode.v1.json","installCommandHtml":"<pre class=\"shiki vitesse-light\" style=\"background-color:#ffffff;color:#393a34\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#59873A\">npx</span><span style=\"color:#B56959\"> shadcn@latest</span><span style=\"color:#B56959\"> add</span><span style=\"color:#B56959\"> https://your-site-url/agent-utils/webresearch-opencode.v1.json</span></span></code></pre>","codeBlocks":[{"id":"registry-webresearch-opencode-files-tool-webresearch-ts","label":"tool/webresearch.ts","path":"registry/webresearch/opencode/files/tool/webresearch.ts","target":"~/.opencode/tool/webresearch.ts","raw":"$12","html":"$13","language":"ts"}]}]}]
c:["$","section",null,{"id":"usage","className":"scroll-mt-24 space-y-6","children":[["$","div",null,{"className":"space-y-2","children":[["$","p",null,{"className":"text-xs font-semibold uppercase tracking-[0.24em] text-muted-foreground","children":"Usage"}],["$","h2",null,{"className":"text-2xl font-semibold tracking-tight text-slate-900","children":"How to use it well"}]]}],["$","div",null,{"className":"rounded-2xl border border-border/70 bg-card/80 text-card-foreground shadow-sm backdrop-blur","children":["$","div",null,{"className":"p-6 pt-6","children":["$","div",null,{"className":"markdown","children":[["$","h3","0",{"children":"1) Frame the decision"}],"\n",["$","p","2",{"children":["State what you are trying to decide or ship. Put that in the ",["$","code","1",{"children":"reason"}]," field so the summary stays focused. The tool runs codex web_search_request under the hood."]}],"\n",["$","h3","4",{"children":"2) Write the queries"}],"\n",["$","p","6",{"children":"Use multiple queries separated by new lines or semicolons to cover edge cases:"}],"\n",["$","pre","8",{"className":"shiki vitesse-light","style":{"backgroundColor":"#ffffff","color":"#393a34"},"tabIndex":"0","children":["$","code",null,{"children":["$","span",null,{"className":"line","children":[["$","span","0",{"style":{"color":"#998418"},"children":"query"}],["$","span","1",{"style":{"color":"#999999"},"children":":"}],["$","span","2",{"style":{"color":"#B5695977"},"children":" \""}],["$","span","3",{"style":{"color":"#B56959"},"children":"Next.js MCP guide; next-devtools-mcp repo; Next.js 16 MCP endpoint"}],["$","span","4",{"style":{"color":"#B5695977"},"children":"\""}]]}]}]}],"\n",["$","h3","10",{"children":"3) Add context and depth"}],"\n",["$","p","12",{"children":"Provide versions, constraints, or must-read sources:"}],"\n",["$","pre","14",{"className":"shiki vitesse-light","style":{"backgroundColor":"#ffffff","color":"#393a34"},"tabIndex":"0","children":["$","code",null,{"children":[["$","span","0",{"className":"line","children":[["$","span","0",{"style":{"color":"#998418"},"children":"additional_context"}],["$","span","1",{"style":{"color":"#999999"},"children":":"}],["$","span","2",{"style":{"color":"#B5695977"},"children":" \""}],["$","span","3",{"style":{"color":"#B56959"},"children":"We are on Next.js 16.0.0; need official docs and repo links"}],["$","span","4",{"style":{"color":"#B5695977"},"children":"\""}]]}],"\n",["$","span","2",{"className":"line","children":[["$","span","0",{"style":{"color":"#998418"},"children":"quality"}],["$","span","1",{"style":{"color":"#999999"},"children":":"}],["$","span","2",{"style":{"color":"#B56959"},"children":" deep"}]]}]]}]}],"\n",["$","h3","16",{"children":"4) Capture output with citations"}],"\n",["$","p","18",{"children":"Paste the summary and sources into your design notes or PR description. If sources conflict, re-run with a narrower follow-up query."}],"\n"]}]}]}]]}]
d:["$","section",null,{"id":"notes","className":"scroll-mt-24 space-y-6","children":[["$","div",null,{"className":"space-y-2","children":[["$","p",null,{"className":"text-xs font-semibold uppercase tracking-[0.24em] text-muted-foreground","children":"Notes"}],["$","h2",null,{"className":"text-2xl font-semibold tracking-tight text-slate-900","children":"Notes"}]]}],["$","div",null,{"className":"rounded-2xl border border-border/70 bg-card/80 text-card-foreground shadow-sm backdrop-blur","children":["$","div",null,{"className":"p-6 pt-6","children":["$","div",null,{"className":"markdown","children":[["$","p","0",{"children":"Web research is permission-gated and requires the codex CLI on your PATH. Some sites block automated fetches; if a source is blocked, use a browser or a dedicated MCP fetch server."}],"\n"]}]}]}]]}]
10:null
